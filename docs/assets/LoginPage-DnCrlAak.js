import{r as i,S as v,U as b,V as s,W as h,X as V,f as a,Y as o,a6 as Q,a0 as _,Z as g}from"./index-B5G9evRI.js";import{_ as P,Q as q,a as k,b as p}from"./_plugin-vue_export-helper-RSNwod5w.js";import{Q as z,a as w}from"./QForm-DXrY6HoK.js";import{Q as C}from"./QCheckbox-CrTJVYZQ.js";import{u as L}from"./use-quasar-DzTJ7Wdc.js";import{supabase as n}from"./supabase-CvbrL4DE.js";import"./use-dark-BbgiJ76y.js";const U={class:"row justify-between items-center q-mt-sm"},B={class:"text-grey-7"},E={__name:"LoginPage",setup(I){const c=L(),y=h(),u=i(""),d=i(""),f=i(!1),m=i(!1),x=async()=>{m.value=!0;try{const{error:r}=await n.auth.signInWithPassword({email:u.value,password:d.value});if(r)throw r;const{data:{user:e}}=await n.auth.getUser(),{data:l}=await n.from("profiles").select("role, status").eq("id",e.id).single();if(l?.role==="teacher"&&l?.status==="pending")throw await n.auth.signOut(),new Error("Your account is pending approval by an administrator.");if(l?.status==="rejected")throw await n.auth.signOut(),new Error("Your account has been rejected.");c.notify({color:"positive",message:"Login successful!",icon:"check"}),y.push("/dashboard")}catch(r){c.notify({color:"negative",message:r.message||"Login failed",icon:"error"})}finally{m.value=!1}};return(r,e)=>{const l=V("router-link");return b(),v(q,{class:"flex flex-center bg-grey-1"},{default:s(()=>[a(k,{class:"auth-card q-pa-lg shadow-4",style:{width:"100%","max-width":"400px"}},{default:s(()=>[a(p,{class:"text-center"},{default:s(()=>[a(Q,{size:"80px","font-size":"40px",color:"red-1","text-color":"primary",icon:"school"}),e[3]||(e[3]=o("div",{class:"text-h5 text-weight-bold q-mt-md text-primary"},"DP Education IT Campus",-1)),e[4]||(e[4]=o("div",{class:"text-subtitle2 text-grey-7"},"Login to your account",-1))]),_:1}),a(p,null,{default:s(()=>[a(z,{onSubmit:x,class:"q-gutter-md"},{default:s(()=>[a(w,{filled:"",modelValue:u.value,"onUpdate:modelValue":e[0]||(e[0]=t=>u.value=t),label:"Email Address",type:"email","lazy-rules":"",rules:[t=>t&&t.length>0||"Please enter your email"]},null,8,["modelValue","rules"]),a(w,{filled:"",modelValue:d.value,"onUpdate:modelValue":e[1]||(e[1]=t=>d.value=t),label:"Password",type:"password","lazy-rules":"",rules:[t=>t&&t.length>0||"Please enter your password"]},null,8,["modelValue","rules"]),o("div",U,[a(C,{modelValue:f.value,"onUpdate:modelValue":e[2]||(e[2]=t=>f.value=t),label:"Remember me",color:"primary"},null,8,["modelValue"]),e[5]||(e[5]=o("a",{href:"#",class:"text-primary text-decoration-none",style:{"font-size":"0.9em"}},"Forgot Password?",-1))]),o("div",null,[a(_,{label:"Login",type:"submit",color:"primary",unelevated:"",rounded:"",class:"full-width q-mt-md",size:"lg",loading:m.value},null,8,["loading"])])]),_:1})]),_:1}),a(p,{class:"text-center q-pt-none"},{default:s(()=>[o("div",B,[e[7]||(e[7]=g(" Don't have an account? ",-1)),a(l,{to:"/register",class:"text-primary text-weight-bold"},{default:s(()=>[...e[6]||(e[6]=[g("Register here",-1)])]),_:1})])]),_:1})]),_:1})]),_:1})}}},F=P(E,[["__scopeId","data-v-82844e00"]]);export{F as default};
